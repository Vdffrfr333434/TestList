<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MSE Enter</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap');

    html, body {
      margin: 0; padding: 0; height: 100%;
      background: url('https://i.ibb.co/67n9YYCS/MSE-Quiz-BG.png') no-repeat center center fixed;
      background-size: cover;
      font-family: 'IBM Plex Sans', sans-serif;
      color: #eee;
      overflow-x: hidden;
      background-color: #000;
    }

    .progress-bar {
  width: 80%;
  height: 12px;
  background-color: #2a2a2a;
  border-radius: 6px;
  margin: 10px auto 0;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  width: 0;
  background-color: #00c8ff;
  transition: width 0.1s linear;
}

    .input-field {
      display: block;
      width: 100%;
      max-width: 400px;
      margin: 10px auto;
      padding: 12px;
      background-color: #1e1e1e;
      color: #eee;
      border: 1px solid #444;
      border-radius: 4px;
      font-family: inherit;
      font-size: 1rem;
      box-sizing: border-box;
      text-align: center;
    }

    #result-blocks div.category-title {
  font-weight: 700;
  font-size: 1.2rem;
  margin-bottom: 6px;
  color: #eee;
}

#result-blocks div.category-comment {
  font-weight: 400;
  font-size: 1rem;
  margin-bottom: 15px;
  color: #ccc;
}


    .full-width-btn {
      width: 100%;
      max-width: 400px;
      margin: 10px auto;
      display: block;
    }

    .center {
      background: #2c2c2c;
      border: 1px solid #444;
      border-radius: 4px;
      padding: 25px 30px;
      max-width: 300px;
      width: 45vw;
      text-align: center;
      user-select: none;
      margin: 25vh auto 40px auto;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeIn 250ms ease-out forwards;
      line-height: 1.2;
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1, h2, h3 {
      margin-bottom: 20px;
      font-weight: 600;
    }

    .btn {
      background: rgba(255,255,255,0.05);
      border: 1px solid #555;
      border-radius: 4px;
      padding: 15px;
      margin: 8px auto;
      width: 45%;
      font-size: 1rem;
      color: #eee;
      cursor: pointer;
      transition: background 0.25s ease;
      user-select: none;
      display: block;
    }

    .btn:hover, .btn.selected {
      background: rgba(255,255,255,0.1);
    }

    .error-message {
      color: red;
      font-size: 0.9rem;
      margin-top: -8px;
      margin-bottom: 10px;
    }

    .hidden {
      display: none;
    }

    @media(max-width: 600px) {
      .center {
        width: 90vw;
        padding: 20px;
      }
      .btn {
        width: 80%;
      }
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>
<body>

<div class="center" id="welcome-screen">
  <img src="https://i.ibb.co/r2K5tJph/MSE-Logo-420-110.png" alt="–õ–æ–≥–æ—Ç–∏–ø MSE" style="max-width: 100%; margin-bottom: 20px;" />

  <input type="text" id="username" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ª–∏–±–æ ID..." />
  <div id="name-error" class="error-message hidden">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è</div>

  <input type="text" id="contact" class="input-field" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏..." />
  <div id="contact-error" class="error-message hidden">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç</div>

  <button class="btn full-width-btn" id="start-btn">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
</div>

<div class="center hidden" id="disclaimer-screen">
  <p style="margin-bottom: 20px;">–î–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–º –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞. –ü—Ä–æ–¥–æ–ª–∂–∞—è, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –º–æ–¥–µ–ª–∏ "–°–æ—Ñ–∏—è".</p>
  <button class="btn" id="agree-btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
  <button class="btn" onclick="window.location.reload()">–û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
</div>

<div class="center hidden" id="question-screen">
  <h3 id="question-category"></h3>
  <div id="question-text"></div>
  <div id="answers"></div>
</div>

<div class="center hidden" id="loader-screen">
  <p>‚ô∫ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...</p>
  <div class="progress-bar">
    <div class="progress-fill" id="progress-fill"></div>
  </div>
</div>

<div class="center hidden" id="results-screen">

<div id="results-header" style="margin-bottom: 20px; text-align: center;">
  <img src="https://i.ibb.co/r2K5tJph/MSE-Logo-420-110.png" alt="–õ–æ–≥–æ—Ç–∏–ø MSE" style="max-width: 100%; height: 60px; margin-bottom: 10px;" />
  <div id="user-info" style="color: #eee; font-size: 0.9rem; margin-bottom: 10px;"></div>
</div>
  
  <div id="result-blocks"></div>
  <button class="btn full-width-btn" id="download-btn"> ‚ô∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
</div>

<script>

  let userName = "";
  let userId = "";

  function generateTestId() {
    return 'TST-' + Math.floor(100000 + Math.random()*900000);
  }
  const commentsByCategory = {
  "–ú–µ—Ç–∞–±–æ–ª–∏–∑–º": [
    { maxScore: 10, text: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —É–≥—Ä–æ–∑–∞. –í —Ö–æ–¥–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω–æ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä—É—é—â–µ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—É—é —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é –∫ —Ä–∞–∑–≤–∏—Ç–∏—é. –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ 4 –º–µ—Å—è—Ü–∞ (2%), 9 –º–µ—Å—è—Ü–µ–≤ (11%), 11 –º–µ—Å—è—Ü–µ–≤ (55%), 16 –º–µ—Å—è—Ü–µ–≤ (83%) –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–∏–º –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤ (25%), 8 –º–µ—Å—è—Ü–µ–≤ (77%), 14 –º–µ—Å—è—Ü–µ–≤ (97%)." },
    { maxScore: 30, text: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É–≥—Ä–æ–∑–∞. –í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–≤–µ—Ç–æ–≤ –±—ã–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞. –í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –æ–Ω–∞ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è, –Ω–æ  –Ω–µ –Ω–µ—Å—ë—Ç –æ—Å–æ–±–æ–π —É–≥—Ä–æ–∑—ã –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞—Ç–∏–º—ã: –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤ (18%), –≤ —Ç–µ—á–µ–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤ (72%), –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –º–µ—Å—è—Ü–µ–≤ (93%)." },
    {  minScore: 35, maxScore: Infinity, text: "–í —Ö–æ–¥–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–µ –±—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º. –ú–µ—Ç–∞–±–æ–ª–∏–∑–º –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ, –≤—Å–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ —Å–±–æ–µ–≤. –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–µ–ª–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º  –Ω–æ—Ä–º–∞–º.." }
  ],
  "–≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω": [
    { maxScore: 5, text: "–£—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω–∞ –≤ –Ω–æ—Ä–º–µ." },
    { maxScore: 10, text: "–ù–∞–±–ª—é–¥–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏." },
    { maxScore: Infinity, text: "–í–æ–∑–º–æ–∂–Ω–∞ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å." }
  ],
  "–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑": [
    { maxScore: 10, text: "–¢–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ." },
    { maxScore: 15, text: "–ï—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç—ã –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö." },
    { maxScore: Infinity, text: "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ü–∏—é." }
  ],
  "–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°": [
    { maxScore: 10, text: "–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏." },
    { maxScore: 15, text: "–ù–∞–±–ª—é–¥–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ä–≤–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏." },
    { maxScore: Infinity, text: "–í–æ–∑–º–æ–∂–Ω–æ, –Ω–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞." }
  ],
  "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å": [
    { maxScore: 10, text: "–í—ã—Å–æ–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–º–∞." },
    { maxScore: 15, text: "–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–Ω—è—è." },
    { maxScore: Infinity, text: "–ê–¥–∞–ø—Ç–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —Å–Ω–∏–∂–µ–Ω–∞." }
  ],
};
const questions = [
  // –ú–µ—Ç–∞–±–æ–ª–∏–∑–º
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è —è:', options: [
    { text: '–ü—Ä–æ–≤–µ—Ä—è—é —Å–æ–æ–±—â–µ–Ω–∏—è', value: 1 },
    { text: '–ó–∞–≤—Ç—Ä–∞–∫–∞—é', value: 1 },
    { text: '–ü—å—é –≤–æ–¥—É/–∫–æ—Ñ–µ, –Ω–æ –Ω–µ –µ–º', value: 3 },
    { text: '–ù–∞–ø—Ä–∞–≤–ª—è—é—Å—å –≤ —É–±–æ—Ä–Ω—É—é', value: 5 },
    { text: '–î–µ–ª–∞—é –∑–∞—Ä—è–¥–∫—É', value: 3 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ú–æ–π –ø–µ—Ä–≤—ã–π –ø—Ä–∏–µ–º –ø–∏—â–∏:', options: [
    { text: '–ó–∞–≤—Ç—Ä–∞–∫ –¥–æ–º–∞', value: 2 },
    { text: '–ó–∞–≤—Ç—Ä–∞–∫ –≤–Ω–µ –¥–æ–º–∞', value: 5 },
    { text: '–û–±–µ–¥ –≤–Ω–µ –¥–æ–º–∞', value: 5 },
    { text: '–ü–æ —Å–∏—Ç—É–∞—Ü–∏–∏', value: 1 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –±–µ–∑ –µ–¥—ã —è:', options: [
    { text: '–ü–µ—Ä–µ–Ω–æ—à—É –±–µ–∑ –ø—Ä–æ–±–ª–µ–º', value: 5 },
    { text: '–ß—É–≤—Å—Ç–≤—É—é –≥–æ–ª–æ–¥', value: 2 },
    { text: '–ù–µ —á—É–≤—Å—Ç–≤—É—é –≥–æ–ª–æ–¥', value: 4 },
    { text: '–ß—É–≤—Å—Ç–≤—É—é —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', value: 1 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ü–æ—Å–ª–µ –µ–¥—ã —è:', options: [
    { text: '–û—â—É—â–∞—é –ø—Ä–∏–ª–∏–≤ —Å–∏–ª –∏ —ç–Ω–µ—Ä–≥–∏–∏', value: 3 },
    { text: '–•–æ—á—É –ø–æ–ª–µ–∂–∞—Ç—å, –ø–µ—Ä–µ–≤–∞—Ä–∏—Ç—å –µ–¥—É', value: 2 },
    { text: '–•–æ—á—É –ø–æ—Ö–æ–¥–∏—Ç—å, –ø–µ—Ä–µ–≤–∞—Ä–∏—Ç—å –µ–¥—É', value: 5 },
    { text: '–•–æ—á—É —Å–ø–∞—Ç—å', value: 1 },
    { text: '–û—â—É—â–∞—é –∂–∞—Ä', value: 5 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ü–æ—Å–ª–µ –µ–¥—ã —è:', options: [
    { text: '–ß—É–≤—Å—Ç–≤—É—é –ø—Ä–∏–≤–∫—É—Å –≤–æ —Ä—Ç—É', value: 1 },
    { text: '–ù–µ —á—É–≤—Å—Ç–≤—É—é –ø—Ä–∏–≤–∫—É—Å–∞', value: 5 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ï—Å–ª–∏ —è –ø–æ–µ–º –∏ —É—Å–Ω—É, —Ç–æ –ø–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è —è:', options: [
    { text: '–ü–æ—á—É–≤—Å—Ç–≤—É—é –ø—Ä–∏–≤–∫—É—Å –≤–æ —Ä—Ç—É', value: 1 },
    { text: '–ù–µ –ø–æ—á—É–≤—Å—Ç–≤—É—é –ø—Ä–∏–≤–∫—É—Å–∞', value: 5 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–Ø –ø—å—é –≤–æ–¥—É:', options: [
    { text: '–ü–æ –æ—â—É—â–µ–Ω–∏—è–º', value: 4 },
    { text: '–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é –≤–æ–¥—É, –ø—å—é —Å–≤–æ—é –Ω–æ—Ä–º—É –≤ –¥–µ–Ω—å', value: 4 },
    { text: '–ù–µ —Å–ª–µ–∂—É –∑–∞ —ç—Ç–∏–º', value: 1 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–°–æ–ª—å:', options: [
    { text: '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–æ–ª—é –µ–¥—É', value: 1 },
    { text: '–†–µ–¥–∫–æ, –∫–æ–≥–¥–∞ –æ—á–µ–Ω—å –ø—Ä–µ—Å–Ω–∞—è', value: 2 },
    { text: '–í–æ–æ–±—â–µ –Ω–µ –¥–æ–±–∞–≤–ª—è—é —Å–æ–ª—å', value: 5 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–Ω–µ —Ö–æ—á–µ—Ç—Å—è:', options: [
    { text: '–ñ–∏—Ä–Ω–æ–≥–æ', value: 3 },
    { text: '–°–ª–∞–¥–∫–æ–≥–æ', value: 1 },
    { text: '–ú—É—á–Ω–æ–≥–æ', value: 1 },
    { text: '–ú–æ–ª–æ—á–Ω–æ–≥–æ', value: 4 },
    { text: '–í–æ–¥—ã', value: 5 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–µ—Å:', options: [
    { text: '–°—Ç–æ–∏—Ç', value: 5 },
    { text: '–†–∞—Å—Ç—ë—Ç', value: 5 },
    { text: '–ü–∞–¥–∞–µ—Ç', value: 1 },
  ]},
  { category: '–ú–µ—Ç–∞–±–æ–ª–∏–∑–º', text: '–£—Ç—Ä–æ–º –≤–µ—Å:', options: [
    { text: '–ë–æ–ª—å—à–µ, —á–µ–º –≤–µ—á–µ—Ä–æ–º', value: 1 },
    { text: '–¢–∞–∫–æ–π –∂–µ', value: 5 },
    { text: '–ú–µ–Ω—å—à–µ, —á–µ–º –≤–µ—á–µ—Ä–æ–º', value: 5 },
  ]},

  // –≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω
  { category: '–≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω', text: '–ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —è —É—Å—Ç–∞—é –æ—Ç:', options: [
    { text: '–°–∏–ª–æ–≤—ã—Ö –Ω–∏–∑–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', value: 1 },
    { text: '–ù–∏–∑–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ –∫–∞—Ä–¥–∏–æ', value: 1 },
    { text: '–í—ã—Å–æ–∫–æ–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ –∫–∞—Ä–¥–∏–æ', value: 5 },
    { text: '–ö—Ä—É–≥–æ–≤—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', value: 5 },
  ]},
  { category: '–≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω', text: '–ú–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏ —è –æ—Ç–¥—ã—Ö–∞—é:', options: [
    { text: '–ú–µ–Ω—å—à–µ –º–∏–Ω—É—Ç—ã', value: 5 },
    { text: '–ë–æ–ª—å—à–µ –º–∏–Ω—É—Ç—ã', value: 1 },
    { text: '–ú–æ–≥—É –≤–æ–æ–±—â–µ –Ω–µ –æ—Ç–¥—ã—Ö–∞—Ç—å', value: 1 },
  ]},
  { category: '–≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω', text: '–ú–µ–∂–¥—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏ —è –æ—Ç–¥—ã—Ö–∞—é:', options: [
    { text: '–ú–µ–Ω—å—à–µ –º–∏–Ω—É—Ç—ã', value: 5 },
    { text: '–ë–æ–ª—å—à–µ —Ç—Ä—ë—Ö –º–∏–Ω—É—Ç', value: 1 },
    { text: '–ú–æ–≥—É –≤–æ–æ–±—â–µ –Ω–µ –æ—Ç–¥—ã—Ö–∞—Ç—å', value: 1 },
  ]},
  { category: '–≠–Ω–µ—Ä–≥–æ–æ–±–º–µ–Ω', text: '–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —è —á—É–≤—Å—Ç–≤—É—é —É—Å—Ç–∞–ª–æ—Å—Ç—å:', options: [
    { text: '–°—Ä–∞–∑—É', value: 1 },
    { text: '–ü–æ –ø—Ä–∏—Ö–æ–¥—É –¥–æ–º–æ–π', value: 3 },
    { text: '–ü–µ—Ä–µ–¥ —Å–Ω–æ–º', value: 5 },
  ]},

  // –¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–í –∂–∞—Ä—É –º–Ω–µ:', options: [
    { text: '–û—á–µ–Ω—å –∂–∞—Ä–∫–æ, –º–Ω–æ–≥–æ –ø–æ—Ç–µ—é', value: 3 },
    { text: '–û—á–µ–Ω—å –∂–∞—Ä–∫–æ, –Ω–æ –Ω–µ –ø–æ—Ç–µ—é –∏–ª–∏ –ø–æ—Ç–µ—é –º–∞–ª–æ', value: 1 },
    { text: '–ù–æ—Ä–º–∞–ª—å–Ω–æ –ø–µ—Ä–µ–Ω–æ—à—É –∂–∞—Ä—É', value: 5 },
  ]},
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–í —Ö–æ–ª–æ–¥–Ω—É—é –ø–æ–≥–æ–¥—É —è:', options: [
    { text: '–û—á–µ–Ω—å –º—ë—Ä–∑–Ω—É –∏ –Ω–µ –º–æ–≥—É —Å–æ–≥—Ä–µ—Ç—å—Å—è', value: 1 },
    { text: '–ù–æ—Ä–º–∞–ª—å–Ω–æ –ø–µ—Ä–µ–Ω–æ—à—É —Ö–æ–ª–æ–¥', value: 5 },
  ]},
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–π –¥—É—à —è –ø–µ—Ä–µ–Ω–æ—à—É', options: [
    { text: '–õ–µ–≥–∫–æ', value: 5 },
    { text: '–í—ã–∑—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', value: 1 },
  ]},
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–•–æ–ª–æ–¥–Ω—É—é –≤–∞–Ω–Ω—É —è –ø–µ—Ä–µ–Ω–æ—à—É:', options: [
    { text: '–õ–µ–≥–∫–æ', value: 5 },
    { text: '–í—ã–∑—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', value: 5 },
  ]},
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–ë–∞–Ω—é –∏–ª–∏ —Å–∞—É–Ω—É —è –ø–µ—Ä–µ–Ω–æ—à—É:', options: [
    { text: '–õ–µ–≥–∫–æ', value: 5 },
    { text: '–í—ã–∑—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', value: 5 },
  ]},
  { category: '–¢–µ—Ä–º–æ–Ω–µ–Ω–µ–∑', text: '–ö–æ–≥–¥–∞ —è —Ç—Ä–µ–Ω–∏—Ä—É—é—Å—å, —è:', options: [
    { text: '–ù–∞–≥—Ä–µ–≤–∞—é—Å—å –∏ –ø–æ—Ç–µ—é', value: 5 },
    { text: '–ü–æ—Ç–µ—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã', value: 1 },
    { text: '–ù–µ –ø–æ—Ç–µ—é, –Ω–µ –Ω–∞–≥—Ä–µ–≤–∞—é—Å—å', value: 3 },
  ]},

  // –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°
  { category: '–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°', text: '–£—Ç—Ä–æ–º —è –≤—Å—Ç–∞—é:', options: [
    { text: '–†–∞–Ω–æ, –±–µ–∑ –±—É–¥–∏–ª—å–Ω–∏–∫–∞', value: 5 },
    { text: '–†–∞–Ω–æ, —Å –±—É–¥–∏–ª—å–Ω–∏–∫–æ–º', value: 2 },
    { text: '–ü–æ —Å–∏—Ç—É–∞—Ü–∏–∏', value: 1 },
    { text: '–í—Å—Ç–∞—é –ø–æ–∑–¥–Ω–æ –∏ —Ç—è–∂–µ–ª–æ', value: 1 },
    { text: '–í—Å—Ç–∞—é –ø–æ–∑–¥–Ω–æ –ª–µ–≥–∫–æ', value: 1 },
  ]},
  { category: '–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°', text: '–Ø –∑–∞—Å—ã–ø–∞—é:', options: [
    { text: '–ë–µ–∑ –ø—Ä–æ–±–ª–µ–º, –≤ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è', value: 5 },
    { text: '–¢—è–∂–µ–ª–æ –∑–∞—Å—ã–ø–∞—é, –∏–Ω–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —É—Å–Ω—É—Ç—å', value: 2 },
    { text: '–ü–æ —Ä–∞–∑–Ω–æ–º—É, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Å—Ç–∞–ª–æ—Å—Ç–∏', value: 1 },
    { text: '–ë–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', value: 1 },
  ]},
  { category: '–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°', text: '–ú–æ–π —Å–æ–Ω:', options: [
    { text: '–ì–ª—É–±–æ–∫–∏–π –∏ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π', value: 5 },
    { text: '–ú–Ω–æ–≥–æ –ø—Ä–æ—Å—ã–ø–∞—é—Å—å –Ω–æ—á—å—é', value: 1 },
    { text: '–ü—Ä–æ—Å—ã–ø–∞—é—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∑–∞ –Ω–æ—á—å', value: 3 },
  ]},
  { category: '–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°', text: '–Ø —Å–ø–ª—é:', options: [
    { text: '–¢–æ–ª—å–∫–æ –Ω–æ—á—å—é', value: 5 },
    { text: '–ú–æ–≥—É –ø–æ—Å–ø–∞—Ç—å –¥–Ω—ë–º', value: 2 },
    { text: '–í—Å–µ–≥–¥–∞ —Å–ø–ª—é –¥–Ω—ë–º', value: 1 },
  ]},
  { category: '–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¶–ù–°', text: '–†–µ–∑–∫–∏–µ –∑–≤—É–∫–∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è:', options: [
    { text: '–û–≥–ª—è–Ω—É—Ç—å—Å—è', value: 5 },
    { text: '–ü—Ä–∏–≥–Ω—É—Ç—å—Å—è', value: 5 },
    { text: '–ù–µ –≤—ã–∑—ã–≤–∞—é—Ç —Ä–µ–∞–∫—Ü–∏–∏', value: 1 },
  ]},

  // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
  { category: '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', text: '–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —è:', options: [
    { text: '–û—á–µ–Ω—å —Ö–æ—á—É –µ—Å—Ç—å', value: 1 },
    { text: '–û—á–µ–Ω—å —Ö–æ—á—É –ø–∏—Ç—å', value: 3 },
    { text: '–ú–æ–≥—É –Ω–µ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤', value: 5 },
    { text: '–•–æ—á—É —Å–ø–∞—Ç—å', value: 3 },
    { text: '–û—â—É—â–∞—é –ø—Ä–∏–ª–∏–≤ —Å–∏–ª', value: 5 },
  ]},
  { category: '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', text: '–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —è –æ—â—É—â–∞—é –±–æ–ª—å:', options: [
    { text: '–í —Ç–æ—Ç –∂–µ –¥–µ–Ω—å', value: 1 },
    { text: '–ù–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å', value: 4 },
    { text: '–ß–µ—Ä–µ–∑ –¥–µ–Ω—å', value: 2 },
    { text: '–ù–µ –æ—â—É—â–∞—é –≤–æ–æ–±—â–µ, —Ö–æ—Ç—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –º–Ω–µ —Ç—è–∂–µ–ª–æ', value: 5 },
  ]},
  { category: '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', text: '–£ –º–µ–Ω—è:', options: [
    { text: '–ù–µ—Ç –æ–¥—ã—à–∫–∏', value: 5 },
    { text: '–ï—Å—Ç—å, –Ω–æ —Ä–µ–¥–∫–æ', value: 3 },
    { text: '–ß–∞—Å—Ç–æ –∑–∞–¥—ã—Ö–∞—é—Å—å', value: 1 },
  ]},
  { category: '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', text: '–û–±—ã—á–Ω–æ —è –¥—ã—à—É:', options: [
    { text: '–ß–µ—Ä–µ–∑ —Ä–æ—Ç', value: 4 },
    { text: '–ß–µ—Ä–µ–∑ –Ω–æ—Å', value: 5 },
    { text: '–ß–µ—Ä–µ–∑ –Ω–æ—Å –∏ —Ä–æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ', value: 1 },
    { text: '–ö–æ–≥–¥–∞ –∫–∞–∫', value: 3 },
  ]},
];


let categories = {};
const questionScreen = document.getElementById('question-screen');
const loaderScreen = document.getElementById('loader-screen');
const resultsScreen = document.getElementById('results-screen');
const resultBlocks = document.getElementById('result-blocks');
let currentQuestion = 0;

function startSurvey() {
  currentQuestion = 0;
  categories = {};
  showQuestion();
}

function showQuestion() {
  const q = questions[currentQuestion];
  document.getElementById('question-category').textContent = q.category;
  document.getElementById('question-text').textContent = q.text;
  const answersDiv = document.getElementById('answers');
  answersDiv.innerHTML = '';
  q.options.forEach((opt) => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = opt.text;
    btn.onclick = () => {
      if (!categories[q.category]) categories[q.category] = 0;
      categories[q.category] += opt.value;
      currentQuestion++;
      if (currentQuestion < questions.length) {
        showQuestion();
     } else {
  questionScreen.classList.add('hidden');
  loaderScreen.classList.remove('hidden');
  const fill = document.getElementById('progress-fill');

  const total = Math.random() * 4000 + 3000; // –æ—Ç 3000 –¥–æ 7000 –ºc
  let elapsed = 0;
  const interval = 100; // –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 100ms

  const timer = setInterval(() => {
    elapsed += interval;
    const pct = Math.min(elapsed / total * 100, 100);
    fill.style.width = pct + '%';

    if (elapsed >= total) {
      clearInterval(timer);
      loaderScreen.classList.add('hidden');
      showResults();
    }
  }, interval);
}
    };
    answersDiv.appendChild(btn);
  });
}

 function showResults() {
    resultsScreen.classList.remove('hidden');
    resultBlocks.innerHTML = '';

    // üöÄ –í—Å—Ç–∞–≤–ª—è–µ–º –∏–º—è, ID, –¥–∞—Ç—É/–≤—Ä–µ–º—è/–¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
    const now = new Date();
    const dtStr = now.toLocaleString('ru-RU', { dateStyle: 'full', timeStyle: 'short' });
    const weekday = now.toLocaleDateString('ru-RU', { weekday: 'long' });
    document.getElementById('user-info').innerHTML = `
      <p><strong>–ò–º—è:</strong> ${userName}</p>
      <p><strong>ID —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong> ${userId}</p>
      <p><strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong> ${dtStr}</p>
      <p><strong>–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏:</strong> ${weekday.charAt(0).toUpperCase() + weekday.slice(1)}</p>
    `;

  for (const cat in categories) {
    const score = categories[cat];
    let comment = '';

    if (commentsByCategory[cat]) {
      for (const item of commentsByCategory[cat]) {
        if (score <= item.maxScore) {
          comment = item.text;
          break;
        }
      }
    } else {
      comment = '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.';
    }

    const titleDiv = document.createElement('div');
    titleDiv.className = 'category-title';
    titleDiv.textContent = cat;

    const commentDiv = document.createElement('div');
    commentDiv.className = 'category-comment';
    commentDiv.textContent = comment;

    resultBlocks.appendChild(titleDiv);
    resultBlocks.appendChild(commentDiv);
  }
}

const startBtn = document.getElementById('start-btn');
const welcomeScreen = document.getElementById('welcome-screen');
const disclaimerScreen = document.getElementById('disclaimer-screen');
const agreeBtn = document.getElementById('agree-btn');
const nameInput = document.getElementById('username');
const contactInput = document.getElementById('contact');
const nameError = document.getElementById('name-error');
const contactError = document.getElementById('contact-error');

 startBtn.addEventListener('click', () => {
    let valid = true;
    nameError.classList.add('hidden');
    contactError.classList.add('hidden');

    if (!nameInput.value.trim()) {
      nameError.classList.remove('hidden');
      valid = false;
    }
    if (!contactInput.value.trim()) {
      contactError.classList.remove('hidden');
      valid = false;
    }
    if (valid) {
      userName = nameInput.value.trim();     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
      userId = generateTestId();            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID
      welcomeScreen.classList.add('hidden');
      disclaimerScreen.classList.remove('hidden');
    }
  });

agreeBtn.addEventListener('click', () => {
  disclaimerScreen.classList.add('hidden');
  questionScreen.classList.remove('hidden');
  startSurvey();
});

document.getElementById('download-btn').addEventListener('click', () => {
  const resultArea = document.getElementById('results-screen');
  const button = document.getElementById('download-btn');

  button.style.visibility = 'hidden';

  setTimeout(() => {
    html2canvas(resultArea, {
      scale: 2,
      useCORS: true,
      backgroundColor: '#050E21'
    }).then(canvas => {
      button.style.visibility = 'visible';

      const imgData = canvas.toDataURL('image/png');
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'px',
        format: [canvas.width, canvas.height]
      });

      pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
      pdf.save('mse_result.pdf');
    });
  }, 100);
});
</script>
</body>
</html>
